<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mindmap: T√≠nh Oxi H√≥a H2SO4 (Chuy√™n S√¢u)</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&family=Patrick+Hand&display=swap" rel="stylesheet">
    
    <!-- C·∫•u h√¨nh MathJax -->
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']]
            },
            svg: {
                fontCache: 'global'
            }
        };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        
        body {
            font-family: 'Roboto', sans-serif;
            background-color: #fff1f2;
            background-image: radial-gradient(#fecdd3 1px, transparent 1px);
            background-size: 20px 20px;
            height: 100vh;
            width: 100vw;
            overflow: hidden;
            user-select: none;
        }

        /* --- CONTROLS --- */
        .controls {
            position: fixed; bottom: 20px; right: 20px;
            background: white; padding: 10px; border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 100; display: flex; gap: 8px;
        }
        
        .btn {
            width: 40px; height: 40px;
            border: 1px solid #e2e8f0; background: white; border-radius: 6px;
            cursor: pointer; font-weight: bold; color: #475569;
            display: flex; align-items: center; justify-content: center;
            font-size: 1.2rem; transition: all 0.2s;
        }
        .btn:hover { background: #f1f5f9; transform: translateY(-2px); }

        .instructions {
            position: fixed; top: 20px; left: 20px;
            background: rgba(255,255,255,0.95);
            padding: 10px 16px; border-radius: 8px;
            font-size: 0.9rem; color: #be123c;
            pointer-events: none; backdrop-filter: blur(4px);
            z-index: 100; border: 1px solid #fda4af;
            box-shadow: 0 2px 8px rgba(225, 29, 72, 0.1);
        }

        /* --- VIEWPORT --- */
        #viewport { width: 100%; height: 100%; cursor: grab; display: flex; align-items: center; justify-content: center; }
        #viewport.grabbing { cursor: grabbing; }
        #mindmap-content { transform-origin: 50% 50%; transition: transform 0.1s ease-out; }

        /* --- MINDMAP NODES --- */
        .mindmap-container { display: flex; align-items: center; padding: 100px; }
        .node { margin: 10px; position: relative; }

        .content {
            background: white; padding: 12px 20px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            border: 2px solid #e2e8f0;
            min-width: 180px; max-width: 280px;
            text-align: center; transition: all 0.2s;
            z-index: 2; position: relative; cursor: pointer;
        }
        .content:hover { transform: scale(1.05) translateY(-2px); box-shadow: 0 10px 20px rgba(225, 29, 72, 0.2); border-color: #f43f5e; }
        .content::after { content: 'üëÜ'; font-size: 0.8rem; position: absolute; top: -8px; right: -8px; opacity: 0; transition: opacity 0.2s; background: white; border-radius: 50%; padding: 2px; }
        .content:hover::after { opacity: 1; }

        /* Connectors */
        .root-connector { width: 60px; height: 4px; background: #9f1239; }
        
        .spine {
            display: flex; flex-direction: column; gap: 50px;
            border-left: 4px solid #9f1239;
            padding: 30px 0;
        }

        .branch { display: flex; align-items: center; position: relative; padding-left: 60px; }
        .branch::before { content: ''; position: absolute; left: 0; top: 50%; width: 60px; height: 4px; background: #9f1239; }

        .sub-branches {
            margin-left: 40px; padding-left: 30px;
            border-left: 2px dashed #fda4af;
            display: flex; flex-direction: column; gap: 20px;
        }
        
        .sub-node { position: relative; display: flex; align-items: center; }
        .sub-node::before { content: ''; position: absolute; left: -30px; top: 50%; width: 30px; height: 2px; border-top: 2px dashed #fda4af; }

        h3 { font-size: 1rem; margin-bottom: 4px; color: #881337; font-weight: 700; }
        p { font-size: 0.85rem; color: #64748b; }
        
        /* Root Node */
        .root .content {
            background: linear-gradient(135deg, #be123c, #9f1239);
            color: white; border: none;
            padding: 25px 40px; max-width: 320px;
            box-shadow: 0 10px 25px rgba(190, 18, 60, 0.4);
        }
        .root h3 { color: white; font-size: 1.8rem; text-transform: uppercase; }
        .root p { color: #fecdd3; }

        /* Branch Colors */
        .br-ban-chat .content { border-left: 6px solid #f43f5e; }
        .br-phi-kim .content { border-left: 6px solid #d946ef; }
        .br-hop-chat .content { border-left: 6px solid #8b5cf6; }
        .br-ket-luan .content { border-left: 6px solid #0ea5e9; }

        .br-ban-chat h3 { color: #e11d48; }
        .br-phi-kim h3 { color: #c026d3; }
        .br-hop-chat h3 { color: #7c3aed; }
        .br-ket-luan h3 { color: #0284c7; }

        /* --- MODAL --- */
        .modal-overlay {
            position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.6);
            display: flex; justify-content: center; align-items: center;
            z-index: 1000; opacity: 0; pointer-events: none; transition: opacity 0.3s;
            backdrop-filter: blur(2px);
        }
        .modal-overlay.active { opacity: 1; pointer-events: all; }

        .modal {
            background: white; width: 90%; max-width: 650px; max-height: 85vh;
            border-radius: 16px; padding: 0;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            transform: translateY(20px); transition: transform 0.3s;
            display: flex; flex-direction: column; overflow: hidden;
        }
        .modal-overlay.active .modal { transform: translateY(0); }

        .modal-header {
            padding: 20px 24px; border-bottom: 1px solid #f1f5f9;
            display: flex; justify-content: space-between; align-items: center;
            background: #fff1f2;
        }
        .modal-title { font-size: 1.4rem; font-weight: bold; color: #9f1239; }
        .modal-close { background: none; border: none; font-size: 2rem; color: #fda4af; cursor: pointer; line-height: 1; }
        .modal-close:hover { color: #e11d48; }

        .modal-body { padding: 24px; overflow-y: auto; font-size: 1rem; line-height: 1.6; color: #334155; }

        .equation {
            background: #f8fafc; padding: 15px; border-radius: 8px;
            margin: 15px 0; font-family: 'Courier New', monospace;
            border-left: 4px solid #e11d48; overflow-x: auto;
            font-weight: bold; color: #334155;
            font-size: 1.1rem;
        }
        .equation-note { font-size: 0.9rem; color: #64748b; margin-top: 5px; font-style: italic; }

        .highlight-box {
            background: #fff1f2; border: 1px solid #fecdd3;
            color: #9f1239; padding: 12px; border-radius: 8px;
            margin-top: 12px; font-weight: 500;
        }
    </style>
</head>
<body>

    <div class="instructions">
        üëÜ <b>Click v√†o √¥</b> ƒë·ªÉ xem n·ªôi dung ‚Ä¢ üñ±Ô∏è K√©o th·∫£ & Zoom
    </div>

    <div class="controls">
        <button class="btn" onclick="zoomOut()">-</button>
        <button class="btn" onclick="resetView()" title="Reset View">‚Ü∫</button>
        <button class="btn" onclick="zoomIn()">+</button>
    </div>

    <div id="viewport">
        <div id="mindmap-content">
            <div class="mindmap-container">
                
                <!-- ROOT -->
                <div class="node root">
                    <div class="content" onclick="showModal('root')">
                        <h3>T√çNH OXI H√ìA</h3>
                        <p>C·ªßa H‚ÇÇSO‚ÇÑ ƒê·∫∑c, N√≥ng</p>
                    </div>
                </div>

                <div class="root-connector"></div>

                <!-- SPINE -->
                <div class="spine">

                    <!-- Branch 1: B·∫¢N CH·∫§T -->
                    <div class="branch br-ban-chat">
                        <div class="content" onclick="showModal('ban_chat')">
                            <h3>üß† B·∫£n Ch·∫•t & Nguy√™n L√Ω</h3>
                            <p>S‚Å∂‚Å∫ nh·∫≠n electron</p>
                        </div>
                        <div class="sub-branches">
                            <div class="sub-node">
                                <div class="content" onclick="showModal('san_pham_khu')">
                                    <h3>S·∫£n Ph·∫©m Kh·ª≠</h3>
                                    <p>SO‚ÇÇ, S, H‚ÇÇS</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Branch 2: T√ÅC D·ª§NG PHI KIM -->
                    <div class="branch br-phi-kim">
                        <div class="content" onclick="showModal('phi_kim_tong_quat')">
                            <h3>üî• T√°c D·ª•ng Phi Kim</h3>
                            <p>C, S, P...</p>
                        </div>
                        <div class="sub-branches">
                            <div class="sub-node">
                                <div class="content" onclick="showModal('carbon')">
                                    <h3>V·ªõi Carbon (C)</h3>
                                    <p>T·∫°o CO‚ÇÇ + SO‚ÇÇ</p>
                                </div>
                            </div>
                            <div class="sub-node">
                                <div class="content" onclick="showModal('luu_huynh')">
                                    <h3>V·ªõi L∆∞u Hu·ª≥nh (S)</h3>
                                    <p>Ra duy nh·∫•t SO‚ÇÇ</p>
                                </div>
                            </div>
                            <div class="sub-node">
                                <div class="content" onclick="showModal('photpho')">
                                    <h3>V·ªõi Phosphor (P)</h3>
                                    <p>T·∫°o H‚ÇÉPO‚ÇÑ</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Branch 3: T√ÅC D·ª§NG H·ª¢P CH·∫§T -->
                    <div class="branch br-hop-chat">
                        <div class="content" onclick="showModal('hop_chat_tong_quat')">
                            <h3>‚öóÔ∏è T√°c D·ª•ng H·ª£p Ch·∫•t</h3>
                            <p>Ch·∫•t kh·ª≠ m·∫°nh</p>
                        </div>
                        <div class="sub-branches">
                            <div class="sub-node">
                                <div class="content" onclick="showModal('kim_loai')">
                                    <h3>V·ªõi Kim Lo·∫°i</h3>
                                    <p>Fe ‚Üí Fe¬≥‚Å∫</p>
                                </div>
                            </div>
                            <div class="sub-node">
                                <div class="content" onclick="showModal('halogen')">
                                    <h3>V·ªõi Halogenua</h3>
                                    <p>NaBr ‚Üí Br‚ÇÇ</p>
                                </div>
                            </div>
                            <div class="sub-node">
                                <div class="content" onclick="showModal('muoi_khu')">
                                    <h3>V·ªõi Mu·ªëi Kh·ª≠</h3>
                                    <p>Na‚ÇÇSO‚ÇÉ ‚Üí Na‚ÇÇSO‚ÇÑ</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Branch 4: K·∫æT LU·∫¨N -->
                    <div class="branch br-ket-luan">
                        <div class="content" onclick="showModal('nhan_biet')">
                            <h3>üìù K·∫øt Lu·∫≠n & Nh·∫≠n Bi·∫øt</h3>
                            <p>D·∫•u hi·ªáu SO‚ÇÇ</p>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <!-- MODAL -->
    <div class="modal-overlay" id="modalOverlay" onclick="closeModal(event)">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title" id="modalTitle">Title</div>
                <button class="modal-close" onclick="closeModalBtn()">√ó</button>
            </div>
            <div class="modal-body" id="modalBody">
                Content goes here...
            </div>
        </div>
    </div>

    <script>
        // --- DATA WITH FIXED LATEX DELIMITERS ---
        const data = {
            'root': {
                title: 'T√≠nh Oxi H√≥a C·ªßa H‚ÇÇSO‚ÇÑ ƒê·∫∑c N√≥ng',
                body: `
                    <p>H‚ÇÇSO‚ÇÑ ƒë·∫∑c, n√≥ng v·ª´a l√† axit m·∫°nh, v·ª´a l√† <b>ch·∫•t oxi h√≥a m·∫°nh</b>.</p>
                    <div class="highlight-box">
                        Nguy√™n t·∫Øc chung: Ch·∫•t c√≥ t√≠nh oxi h√≥a l√† ch·∫•t <b>nh·∫≠n electron</b> (b·ªã kh·ª≠).
                    </div>
                `
            },
            'ban_chat': {
                title: 'B·∫£n Ch·∫•t & Nguy√™n L√Ω',
                body: `
                    <p>Trong g·ªëc sunfat ($SO_4^{2-}$), nguy√™n t·ª≠ L∆∞u hu·ª≥nh ($S$) c√≥ s·ªë oxi h√≥a cao nh·∫•t l√† <b>+6</b>.</p>
                    <p>Do ƒë√≥, n√≥ c√≥ xu h∆∞·ªõng m·∫°nh m·∫Ω ƒë·ªÉ <b>nh·∫≠n electron</b> t·ª´ c√°c ch·∫•t kh√°c ƒë·ªÉ gi·∫£m xu·ªëng c√°c m·ª©c oxi h√≥a th·∫•p h∆°n.</p>
                    <div class="equation">$$S^{+6} + ne \\rightarrow S_{sp\\_khu}$$</div>
                `
            },
            'san_pham_khu': {
                title: 'C√°c S·∫£n Ph·∫©m Kh·ª≠ C·ªßa S+6',
                body: `
                    <p>T√πy thu·ªôc v√†o ƒë·ªô m·∫°nh c·ªßa ch·∫•t kh·ª≠ ph·∫£n ·ª©ng c√πng, $S^{+6}$ c√≥ th·ªÉ b·ªã kh·ª≠ xu·ªëng:</p>
                    <ul>
                        <li><b>$S^{+4}$ ($SO_2$):</b> Kh√≠ m√πi h·∫Øc (S·∫£n ph·∫©m ph·ªï bi·∫øn nh·∫•t).</li>
                        <li><b>$S^0$ (S):</b> Ch·∫•t r·∫Øn m√†u v√†ng (G·∫∑p ch·∫•t kh·ª≠ m·∫°nh nh∆∞ Mg, Zn).</li>
                        <li><b>$S^{-2}$ ($H_2S$):</b> Kh√≠ m√πi tr·ª©ng th·ªëi (G·∫∑p ch·∫•t kh·ª≠ r·∫•t m·∫°nh).</li>
                    </ul>
                `
            },
            'phi_kim_tong_quat': {
                title: 'T√°c D·ª•ng V·ªõi Phi Kim',
                body: `
                    <p>H‚ÇÇSO‚ÇÑ ƒë·∫∑c n√≥ng oxi h√≥a ƒë∆∞·ª£c nhi·ªÅu phi kim (C, S, P...) l√™n m·ª©c oxi h√≥a cao nh·∫•t c·ªßa ch√∫ng (th∆∞·ªùng l√† Oxit ho·∫∑c Axit t∆∞∆°ng ·ª©ng).</p>
                    <p>B·∫£n th√¢n H‚ÇÇSO‚ÇÑ th∆∞·ªùng b·ªã kh·ª≠ v·ªÅ $SO_2$.</p>
                `
            },
            'carbon': {
                title: 'Ph·∫£n ·ª®ng V·ªõi Carbon (C)',
                body: `
                    <p>Carbon b·ªã oxi h√≥a t·ª´ 0 l√™n +4 ($CO_2$).</p>
                    <div class="equation">$$C + 2H_2SO_4 \\text{ (ƒë·∫∑c)} \\rightarrow CO_2 + 2SO_2 + 2H_2O$$</div>
                    <p class="equation-note">Hi·ªán t∆∞·ª£ng: S·ªßi b·ªçt kh√≠ m·∫°nh (h·ªón h·ª£p kh√≠ tho√°t ra).</p>
                `
            },
            'luu_huynh': {
                title: 'Ph·∫£n ·ª®ng V·ªõi L∆∞u Hu·ª≥nh (S)',
                body: `
                    <p>L∆∞u hu·ª≥nh b·ªã oxi h√≥a t·ª´ 0 l√™n +4 ($SO_2$). Axit c≈©ng b·ªã kh·ª≠ v·ªÅ +4.</p>
                    <div class="equation">$$S + 2H_2SO_4 \\text{ (ƒë·∫∑c)} \\rightarrow 3SO_2 + 2H_2O$$</div>
                    <div class="highlight-box">Ph·∫£n ·ª©ng n√†y t·∫°o ra duy nh·∫•t m·ªôt lo·∫°i kh√≠ l√† $SO_2$.</div>
                `
            },
            'photpho': {
                title: 'Ph·∫£n ·ª®ng V·ªõi Phosphor (P)',
                body: `
                    <p>Phosphor b·ªã oxi h√≥a t·ª´ 0 l√™n +5 (trong axit photphoric $H_3PO_4$).</p>
                    <div class="equation">$$2P + 5H_2SO_4 \\text{ (ƒë·∫∑c)} \\rightarrow 2H_3PO_4 + 5SO_2 + 2H_2O$$</div>
                `
            },
            'hop_chat_tong_quat': {
                title: 'T√°c D·ª•ng V·ªõi H·ª£p Ch·∫•t',
                body: `
                    <p>H‚ÇÇSO‚ÇÑ ƒë·∫∑c oxi h√≥a c√°c h·ª£p ch·∫•t c√≥ t√≠nh kh·ª≠ (nguy√™n t·ªë ch∆∞a ƒë·∫°t h√≥a tr·ªã cao nh·∫•t) l√™n m·ª©c cao nh·∫•t.</p>
                `
            },
            'kim_loai': {
                title: 'T√°c D·ª•ng V·ªõi Kim Lo·∫°i (Tr·ª´ Au, Pt)',
                body: `
                    <p>Oxi h√≥a kim lo·∫°i l√™n h√≥a tr·ªã cao nh·∫•t (v√≠ d·ª• Fe l√™n Fe¬≥‚Å∫).</p>
                    <div class="equation">$$2Fe + 6H_2SO_4 \\text{ (ƒë·∫∑c)} \\rightarrow Fe_2(SO_4)_3 + 3SO_2 + 6H_2O$$</div>
                    <div class="highlight-box">Kh√°c v·ªõi axit lo√£ng ch·ªâ ƒë∆∞a Fe l√™n Fe¬≤‚Å∫ v√† gi·∫£i ph√≥ng $H_2$.</div>
                `
            },
            'halogen': {
                title: 'T√°c D·ª•ng V·ªõi H·ª£p Ch·∫•t Halogen',
                body: `
                    <p>C√≥ th·ªÉ oxi h√≥a ion Halogenua ($Br^-$, $I^-$) th√†nh ƒë∆°n ch·∫•t.</p>
                    <p>V√≠ d·ª• v·ªõi NaBr:</p>
                    <div class="equation">$$2NaBr + 2H_2SO_4 \\text{ (ƒë·∫∑c)} \\rightarrow Na_2SO_4 + Br_2 + SO_2 + 2H_2O$$</div>
                    <p class="equation-note">ƒê√¢y l√† l√Ω do kh√¥ng d√πng H‚ÇÇSO‚ÇÑ ƒë·∫∑c ƒë·ªÉ ƒëi·ªÅu ch·∫ø kh√≠ HBr hay HI.</p>
                `
            },
            'muoi_khu': {
                title: 'T√°c D·ª•ng V·ªõi Mu·ªëi C√≥ T√≠nh Kh·ª≠',
                body: `
                    <p>V√≠ d·ª• v·ªõi mu·ªëi Sunfit ($SO_3^{2-}$ ch·ª©a S‚Å∫‚Å¥):</p>
                    <div class="equation">$$Na_2SO_3 + H_2SO_4 \\rightarrow Na_2SO_4 + SO_2 + H_2O$$</div>
                    <p>Trong ph·∫£n ·ª©ng n√†y $S^{+4}$ trong mu·ªëi ƒë√≥ng vai tr√≤ ch·∫•t kh·ª≠ (n·∫øu x√©t theo kh√≠a c·∫°nh axit m·∫°nh ƒë·∫©y axit y·∫øu th√¨ n√≥ gi·∫£i ph√≥ng SO‚ÇÇ).</p>
                `
            },
            'nhan_biet': {
                title: 'K·∫øt Lu·∫≠n & Nh·∫≠n Bi·∫øt',
                body: `
                    <p><b>ƒê·∫∑c tr∆∞ng nh·∫≠n bi·∫øt ph·∫£n ·ª©ng oxi h√≥a c·ªßa H‚ÇÇSO‚ÇÑ ƒë·∫∑c:</b></p>
                    <ul>
                        <li>Sinh ra kh√≠ <b>$SO_2$</b> c√≥ m√πi h·∫Øc.</li>
                        <li>Kh√≠ n√†y l√†m m·∫•t m√†u dung d·ªãch <b>Brom ($Br_2$)</b> ho·∫∑c <b>Thu·ªëc t√≠m ($KMnO_4$)</b>.</li>
                    </ul>
                `
            }
        };

        function showModal(key) {
            const content = data[key];
            if(content) {
                document.getElementById('modalTitle').innerText = content.title;
                document.getElementById('modalBody').innerHTML = content.body;
                document.getElementById('modalOverlay').classList.add('active');
                // Rerender MathJax for new content
                if(window.MathJax) {
                    MathJax.typesetPromise([document.getElementById('modalBody')]);
                }
            }
        }

        function closeModal(e) {
            if(e.target.id === 'modalOverlay') document.getElementById('modalOverlay').classList.remove('active');
        }
        function closeModalBtn() { document.getElementById('modalOverlay').classList.remove('active'); }

        const viewport = document.getElementById('viewport');
        const contentEl = document.getElementById('mindmap-content');
        let scale = 1, pointX = 0, pointY = 0, isPanning = false, startX = 0, startY = 0;

        function zoomIn() { scale *= 1.2; updateTransform(); }
        function zoomOut() { scale /= 1.2; updateTransform(); }

        viewport.addEventListener('mousedown', (e) => { isPanning = true; startX = e.clientX - pointX; startY = e.clientY - pointY; viewport.classList.add('grabbing'); });
        window.addEventListener('mousemove', (e) => { if (!isPanning) return; e.preventDefault(); pointX = e.clientX - startX; pointY = e.clientY - startY; updateTransform(); });
        window.addEventListener('mouseup', () => { isPanning = false; viewport.classList.remove('grabbing'); });
        viewport.addEventListener('wheel', (e) => { e.preventDefault(); const delta = -e.deltaY; (delta > 0) ? (scale *= 1.1) : (scale /= 1.1); scale = Math.min(Math.max(0.1, scale), 5); updateTransform(); }, { passive: false });

        function updateTransform() { contentEl.style.transform = `translate(${pointX}px, ${pointY}px) scale(${scale})`; }
        function resetView() { scale = 1; pointX = 0; pointY = 0; updateTransform(); }
        window.onload = function() { scale = 0.9; updateTransform(); }
    </script>
</body>
</html>
